<!DOCTYPE html>
<html lang="en-US">
    <head>
        <title>count words</title>
    </head>
    <body>
        <button>Play</button>
        <audio src="t.mp3" controls></audio>
        <input type=range min=0.5 max=10 step=0.1 value=0.5></input>
        <script>
            let ac = new AudioContext;
            let audioElement = document.querySelector("audio");
            let source = ac.createMediaElementSource(audioElement);

            async function play() {
            await ac.audioWorklet.addModule('clipper.js');

            ac.resume();
            audioElement.play();

            let softclipper = new AudioWorkletNode(ac, 'soft-clipper-node');
            source.connect(softclipper).connect(ac.destination);

            document.querySelector("input").oninput = function(e) {
                console.log("Amount is now " + e.target.value);
                softclipper.parameters.get("amount").value = e.target.value;
            }
            };

            document.querySelector("button").onclick = function() {
            play();
            }
        </script>
    </body>
</html>