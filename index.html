<!DOCTYPE html>
<html lang="en-US">
    <head>
        <title>sdft</title>
    </head>
    <body>
        <button>Play</button>
        <audio src="t.mp3" controls></audio>
        <input type="range" min="0.5" max="10" step="0.1" value="0.5">
        <script>
            const ac = new AudioContext()
            const audioElement = document.querySelector('audio')
            const source = ac.createMediaElementSource(audioElement)

            async function play () {
              await ac.audioWorklet.addModule('sdft.js')
              ac.resume()
              audioElement.play()

              const sdft = new AudioWorkletNode(ac, 'sliding-dft-node')
              source.connect(sdft).connect(ac.destination)

              document.querySelector('input').oninput = function (e) {
                console.log('Amount is now ' + e.target.value)
                sdft.parameters.get('amount').value = e.target.value
              }
            }

            document.querySelector('button').onclick = function () {
              play()
            }
        </script>
    </body>
</html>